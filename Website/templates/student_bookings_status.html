{% extends "base.html" %} {% block content %}
<div class="container py-5">
  <h2 class="text-center mb-4">My Booking Requests</h2>

  {% if bookings %}
  <div class="table-responsive">
    <table class="table table-striped table-bordered text-center align-middle">
      <thead class="table-primary">
        <tr>
          <th>Room</th>
          <th>Time Slot</th>
          <th>Date</th>
          <th>Status</th>
          <th>Reviewed By</th>
          <th>Reviewed On</th>
        </tr>
      </thead>
      <tbody>
        {% for booking in bookings %}
        <tr>
          <td>{{ booking.room.room_name }}</td>
          <td>
            {% if booking.room_timeslot and booking.room_timeslot.timeslot %} {{
            booking.room_timeslot.timeslot.start_time.strftime('%H:%M') }} - {{
            booking.room_timeslot.timeslot.end_time.strftime('%H:%M') }} {% else
            %} Not Set {% endif %}
          </td>
          <td>{{ booking.booking_date.strftime('%Y-%m-%d') }}</td>

          <td>
            {% if booking.status == 'Pending' %}
            <span class="badge bg-warning text-dark">Pending</span>
            {% elif booking.status == 'Approved' %}
            <span class="badge bg-success">Approved</span>
            {% elif booking.status == 'Denied' or booking.status == 'Cancelled'
            %}
            <span class="badge bg-danger">Denied</span>
            {% endif %}
          </td>

          <td>
            {% set approval = booking.approvals[0] if booking.approvals else
            None %} {% if approval and approval.reviewer %} {{
            approval.reviewer.first_name }} {% else %} - {% endif %}
          </td>

          <td>
            {% if approval %} {{ approval.review_date.strftime('%Y-%m-%d %H:%M')
            }} {% else %} - {% endif %}
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  {% else %}
  <p class="text-center text-muted">
    You have not made any booking requests yet.
  </p>
  {% endif %}

  <div class="text-center mt-4">
    <a href="{{ url_for('views.student_portal') }}" class="btn btn-primary"
      >‚Üê Back to Dashboard</a
    >
  </div>
</div>
{% endblock %}
